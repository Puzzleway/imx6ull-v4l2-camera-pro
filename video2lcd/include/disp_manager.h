#ifndef _DISP_MANAGER_H
#define _DISP_MANAGER_H

#include <pic_operation.h>
#include <video_manager.h>

/* ��ʾ����,������������Ͻ�/���½�����
 * �����ͼ��,������ͼ����ļ���
 */
typedef struct Layout {
	int iTopLeftX;
	int iTopLeftY;
	int iBotRightX;
	int iBotRightY;
	char *strIconName;
}T_Layout, *PT_Layout;


/* VideoMem��״̬:
 * ����/����Ԥ��׼����ʾ����/���ڵ�ǰ�߳�
 */
typedef enum {
	VMS_FREE = 0,
	VMS_USED_FOR_PREPARE,
	VMS_USED_FOR_CUR,	
}E_VideoMemState;

/* VideoMem���ڴ���ͼƬ��״̬:
 * �հ�/��������/�Ѿ�����
 */
typedef enum {
	PS_BLANK = 0,
	PS_GENERATING,
	PS_GENERATED,	
}E_PicState;


typedef struct VideoMem {
	int iID;                        /* IDֵ,���ڱ�ʶ��ͬ��ҳ�� */
	int bDevFrameBuffer;            /* 1: ���VideoMem����ʾ�豸���Դ�; 0: ֻ��һ����ͨ���� */
	E_VideoMemState eVideoMemState; /* ���VideoMem��״̬ */
	E_PicState ePicState;           /* VideoMem���ڴ���ͼƬ��״̬ */
	T_PixelDatas tPixelDatas;       /* �ڴ�: �����洢ͼ�� */
	struct VideoMem *ptNext;        /* ���� */
}T_VideoMem, *PT_VideoMem;

typedef struct DispOpr {
	char *name;              /* ��ʾģ������� */
	int iXres;               /* X�ֱ��� */
	int iYres;               /* Y�ֱ��� */
	int iBpp;                /* һ�������ö���λ����ʾ */
	int iLineWidth;          /* һ������ռ�ݶ����ֽ� */
	unsigned char *pucDispMem;   /* �Դ��ַ */
	int (*DeviceInit)(void);     /* �豸��ʼ������ */
	int (*ShowPixel)(int iPenX, int iPenY, unsigned int dwColor);    /* ��ָ�������������Ϊĳ��ɫ */
	int (*CleanScreen)(unsigned int dwBackColor);                    /* ����Ϊĳ��ɫ */
	int (*ShowPage)(PT_PixelDatas ptPixelDatas);                         /* ��ʾһҳ,����Դ��ptVideoMem */
	struct DispOpr *ptNext;      /* ���� */
}T_DispOpr, *PT_DispOpr;

/**********************************************************************
 * �������ƣ� RegisterDispOpr
 * ���������� ע��"��ʾģ��", ������֧�ֵ���ʾ�豸�Ĳ���������������
 * ��������� ptDispOpr - һ���ṹ��,�ں���ʾ�豸�Ĳ�������
 * ��������� ��
 * �� �� ֵ�� 0 - �ɹ�, ����ֵ - ʧ��
 * �޸�����        �汾��     �޸���	      �޸�����
 * -----------------------------------------------
 * 2013/02/08	     V1.0	  Τ��ɽ	      ����
 ***********************************************************************/
int RegisterDispOpr(PT_DispOpr ptDispOpr);

/**********************************************************************
 * �������ƣ� ShowDispOpr
 * ���������� ��ʾ��������֧�ֵ�"��ʾģ��"
 * ��������� ��
 * ��������� ��
 * �� �� ֵ�� ��
 * �޸�����        �汾��     �޸���	      �޸�����
 * -----------------------------------------------
 * 2013/02/08	     V1.0	  Τ��ɽ	      ����
 ***********************************************************************/
void ShowDispOpr(void);

/**********************************************************************
 * �������ƣ� DisplayInit
 * ���������� ע����ʾ�豸
 * ��������� ��
 * ��������� ��
 * �� �� ֵ�� 0 - �ɹ�, ����ֵ - ʧ��
 * �޸�����        �汾��     �޸���	      �޸�����
 * -----------------------------------------------
 * 2013/02/08	     V1.0	  Τ��ɽ	      ����
 ***********************************************************************/
int DisplayInit(void);

/**********************************************************************
 * �������ƣ� SelectAndInitDefaultDispDev
 * ���������� ��������ȡ��ָ����"��ʾģ��", �������ĳ�ʼ������, ��������
 * ��������� name - ����
 * ��������� ��
 * �� �� ֵ�� ��
 * �޸�����        �汾��     �޸���	      �޸�����
 * -----------------------------------------------
 * 2013/02/08	     V1.0	  Τ��ɽ	      ����
 ***********************************************************************/
void SelectAndInitDefaultDispDev(char *name);

/**********************************************************************
 * �������ƣ� GetDefaultDispDev
 * ���������� ����������SelectAndInitDefaultDispDevѡ������ʾģ��,
 *            ���������ظ���ʾģ��
 * ��������� ��
 * ��������� ��
 * �� �� ֵ�� ��ʾģ���PT_DispOpr�ṹ��ָ��
 * �޸�����        �汾��     �޸���	      �޸�����
 * -----------------------------------------------
 * 2013/02/08	     V1.0	  Τ��ɽ	      ����
 ***********************************************************************/
PT_DispOpr GetDefaultDispDev(void);

/**********************************************************************
 * �������ƣ� GetDispResolution
 * ���������� �����ʹ�õ���ʾ�豸�ķֱ��ʺ�BPP
 * ��������� ��
 * ��������� piXres - ��X�ֱ���
 *            piYres - ��X�ֱ���
 *            piBpp  - ��BPP
 * �� �� ֵ�� 0  - �ɹ�
 *            -1 - ʧ��(δʹ��SelectAndInitDefaultDispDev��ѡ����ʾģ��)
 * �޸�����        �汾��     �޸���	      �޸�����
 * -----------------------------------------------
 * 2013/02/08	     V1.0	  Τ��ɽ	      ����
 ***********************************************************************/
int GetDispResolution(int *piXres, int *piYres, int *piBpp);

/**********************************************************************
 * �������ƣ� AllocVideoMem
 * ���������� VideoMem: Ϊ�ӿ���ʾ�ٶ�,���������ڻ����й������ʾ��ҳ�������,
 *            (��������ΪVideoMem)
 *            ��ʾʱ�ٰ�VideoMem�е����ݸ��Ƶ��豸���Դ���
 * ��������� iNum
 * ��������� ��
 * �� �� ֵ�� 0  - �ɹ�
 *            -1 - ʧ��(δʹ��SelectAndInitDefaultDispDev��ѡ����ʾģ��)
 * �޸�����        �汾��     �޸���	      �޸�����
 * -----------------------------------------------
 * 2013/02/08	     V1.0	  Τ��ɽ	      ����
 ***********************************************************************/
int AllocVideoMem(int iNum);

/**********************************************************************
 * �������ƣ� GetDevVideoMem
 * ���������� �����ʾ�豸���Դ�, �ڸ��Դ��ϲ����Ϳ���ֱ����LCD����ʾ����
 * ��������� ��
 * ��������� ��
 * �� �� ֵ�� �Դ��Ӧ��VideoMem�ṹ��ָ��
 * �޸�����        �汾��     �޸���	      �޸�����
 * -----------------------------------------------
 * 2013/02/08	     V1.0	  Τ��ɽ	      ����
 ***********************************************************************/
PT_VideoMem GetDevVideoMem(void);

/**********************************************************************
 * �������ƣ� GetVideoMem
 * ���������� ���һ��ɲ�����VideoMem(�����ڴ洢Ҫ��ʾ������), 
 *            �������PutVideoMem���ͷ�
 * ��������� iID  - IDֵ,�ȳ������ڶ�VideoMem���ҵ�IDֵ��ͬ��
 *            bCur - 1��ʾ��ǰ��������Ҫʹ��VideoMem,�޷���ζ�Ҫ����һ��VideoMem
 *                   0��ʾ����Ϊ�˸Ľ����ܶ���ǰȡ��VideoMem,���Ǳ����
 * ��������� ��
 * �� �� ֵ�� NULL   - ʧ��,û�п��õ�VideoMem
 *            ��NULL - �ɹ�,����PT_VideoMem�ṹ��
 * �޸�����        �汾��     �޸���	      �޸�����
 * -----------------------------------------------
 * 2013/02/08	     V1.0	  Τ��ɽ	      ����
 ***********************************************************************/
PT_VideoMem GetVideoMem(int iID, int bCur);

/**********************************************************************
 * �������ƣ� PutVideoMem
 * ���������� ʹ��GetVideoMem��õ�VideoMem, ����ʱ��PutVideoMem�ͷŵ�
 * ��������� ptVideoMem - ʹ����ϵ�VideoMem
 * ��������� ��
 * �� �� ֵ�� ��
 * �޸�����        �汾��     �޸���	      �޸�����
 * -----------------------------------------------
 * 2013/02/08	     V1.0	  Τ��ɽ	      ����
 ***********************************************************************/
void PutVideoMem(PT_VideoMem ptVideoMem);

/**********************************************************************
 * �������ƣ� ClearVideoMem
 * ���������� ��VideoMem���ڴ�ȫ����Ϊĳ����ɫ
 * ��������� ptVideoMem - VideoMem�ṹ��ָ��, �ں�Ҫ�������ڴ�
 *            dwColor    - ����Ϊ����ɫ
 * ��������� ��
 * �� �� ֵ�� ��
 * �޸�����        �汾��     �޸���	      �޸�����
 * -----------------------------------------------
 * 2013/02/08	     V1.0	  Τ��ɽ	      ����
 ***********************************************************************/
void ClearVideoMem(PT_VideoMem ptVideoMem, unsigned int dwColor);

/**********************************************************************
 * �������ƣ� ClearVideoMemRegion
 * ���������� ��VideoMem���ڴ��ָ������ȫ����Ϊĳ����ɫ
 * ��������� ptVideoMem - VideoMem�ṹ��ָ��, �ں�Ҫ�������ڴ�
 *            ptLayout   - ��������, ָ�������Ͻ�,���ڽǵ�����
 *            dwColor    - ����Ϊ����ɫ
 * ��������� ��
 * �� �� ֵ�� ��
 * �޸�����        �汾��     �޸���	      �޸�����
 * -----------------------------------------------
 * 2013/02/08	     V1.0	  Τ��ɽ	      ����
 ***********************************************************************/
void ClearVideoMemRegion(PT_VideoMem ptVideoMem, PT_Layout ptLayout, unsigned int dwColor);

/**********************************************************************
 * �������ƣ� FBInit
 * ���������� ע��"framebuffer��ʾ�豸"
 * ��������� ��
 * ��������� ��
 * �� �� ֵ�� 0 - �ɹ�, ����ֵ - ʧ��
 * �޸�����        �汾��     �޸���	      �޸�����
 * -----------------------------------------------
 * 2013/02/08	     V1.0	  Τ��ɽ	      ����
 ***********************************************************************/
int FBInit(void);

int GetVideoBufForDisplay(PT_VideoBuf ptFrameBuf);
void FlushPixelDatasToDev(PT_PixelDatas ptPixelDatas);
PT_DispOpr GetDispOpr(char *pcName);
#endif /* _DISP_MANAGER_H */

